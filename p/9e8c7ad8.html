<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"guiu.xyz","root":"/","scheme":"Pisces","version":"7.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="考研备考之余练练逆向，从ad-world进阶区刷起，每晚一道； re3 re2-cpp-is-awesome 12345678910111213141516171819202122232425262728293031323334353637383940__int64 __fastcall main(int a1, char **a2, char **a3)&amp;#123;  char *v3; &#x2F;&#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="攻防世界re-writeup">
<meta property="og:url" content="http://guiu.xyz/p/9e8c7ad8.html">
<meta property="og:site_name" content="Hcl的个人小站">
<meta property="og:description" content="考研备考之余练练逆向，从ad-world进阶区刷起，每晚一道； re3 re2-cpp-is-awesome 12345678910111213141516171819202122232425262728293031323334353637383940__int64 __fastcall main(int a1, char **a2, char **a3)&amp;#123;  char *v3; &#x2F;&#x2F;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://sz.guiu.xyz/images/2020/02/25/1568825865249.png">
<meta property="og:image" content="http://sz.guiu.xyz/images/2020/02/25/1568826064065.png">
<meta property="og:image" content="http://sz.guiu.xyz/images/2020/02/25/1568826136759.png">
<meta property="og:image" content="http://sz.guiu.xyz/images/2020/02/25/1568826359276.png">
<meta property="og:image" content="http://sz.guiu.xyz/images/2020/02/25/1568910853160.png">
<meta property="og:image" content="http://sz.guiu.xyz/images/2020/02/25/1568910949165.png">
<meta property="og:image" content="http://sz.guiu.xyz/images/2020/02/25/1568911945157.png">
<meta property="og:image" content="http://sz.guiu.xyz/images/2020/02/25/1569082454698.png">
<meta property="og:image" content="http://sz.guiu.xyz/images/2020/02/25/1569082817612.png">
<meta property="og:image" content="http://sz.guiu.xyz/images/2020/02/25/1569083871879.png">
<meta property="og:image" content="http://sz.guiu.xyz/images/2020/02/25/1569083952906.png">
<meta property="og:image" content="http://sz.guiu.xyz/images/2020/02/25/1569250903863.png">
<meta property="og:image" content="http://sz.guiu.xyz/images/2020/02/25/1569250467584.png">
<meta property="og:image" content="http://sz.guiu.xyz/images/2020/02/25/1569250997311.png">
<meta property="og:image" content="http://sz.guiu.xyz/images/2020/02/25/1569254213469.png">
<meta property="article:published_time" content="2019-10-30T03:28:33.000Z">
<meta property="article:modified_time" content="2019-10-30T03:28:33.000Z">
<meta property="article:author" content="guiu">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Writeup">
<meta property="article:tag" content="逆向">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://sz.guiu.xyz/images/2020/02/25/1568825865249.png">

<link rel="canonical" href="http://guiu.xyz/p/9e8c7ad8.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>攻防世界re-writeup | Hcl的个人小站</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hcl的个人小站</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://guiu.xyz/p/9e8c7ad8.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="guiu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hcl的个人小站">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          攻防世界re-writeup
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-30 11:28:33" itemprop="dateCreated datePublished" datetime="2019-10-30T11:28:33+08:00">2019-10-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF%E7%9B%B8%E5%85%B3/" itemprop="url" rel="index"><span itemprop="name">CTF相关</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>考研备考之余练练逆向，从ad-world进阶区刷起，每晚一道；</p>
<h1>re3 re2-cpp-is-awesome</h1>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v3; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v6; <span class="comment">// rax</span></span><br><span class="line">  __int64 v7; <span class="comment">// rdx</span></span><br><span class="line">  _BYTE *v8; <span class="comment">// rax</span></span><br><span class="line">  __int64 i; <span class="comment">// [rsp+10h] [rbp-60h]</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// [rsp+20h] [rbp-50h]</span></span><br><span class="line">  <span class="keyword">char</span> v12; <span class="comment">// [rsp+4Fh] [rbp-21h]</span></span><br><span class="line">  __int64 v13; <span class="comment">// [rsp+50h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// [rsp+5Ch] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a1 != <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = *a2;</span><br><span class="line">    v4 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"Usage: "</span>, a3);</span><br><span class="line">    v6 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(v4, v3, v5);</span><br><span class="line">    <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(v6, <span class="string">" flag\n"</span>, v7);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;::allocator(&amp;v12, a2, a3);</span><br><span class="line">  <span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::basic_string(&amp;v11, a2[<span class="number">1</span>], &amp;v12);</span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;::~allocator(&amp;v12);</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::<span class="built_in">begin</span>(&amp;v11); ; sub_400D7A(&amp;i) )</span><br><span class="line">  &#123;</span><br><span class="line">    v13 = <span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::<span class="built_in">end</span>(&amp;v11);</span><br><span class="line">    <span class="keyword">if</span> ( !(<span class="keyword">unsigned</span> __int8)sub_400D3D(&amp;i, &amp;v13) )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v8 = (_BYTE *)sub_400D9A(&amp;i);</span><br><span class="line">    <span class="keyword">if</span> ( *v8 != off_6020A0[dword_6020C0[v14]] ) <span class="comment">// 关键点</span></span><br><span class="line">      sub_400B56();</span><br><span class="line">    ++v14;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_400B73();</span><br><span class="line">  <span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::~basic_string(&amp;v11);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>dword_6020c0:</p>
<p><img src="http://sz.guiu.xyz/images/2020/02/25/1568825865249.png" alt="1568825865249.png"></p>
<p>dump下来写脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">off_6020a0 = <span class="string">"L3t_ME_T3ll_Y0u_S0m3th1ng_1mp0rtant_A_&#123;FL4G&#125;_W0nt_b3_3X4ctly_th4t_345y_t0_c4ptur3_H0wev3r_1T_w1ll_b3_C00l_1F_Y0u_g0t_1t"</span></span><br><span class="line"></span><br><span class="line">dword_6020c0 =  [<span class="number">0x24</span>, <span class="number">0x5</span>, <span class="number">0x36</span>, <span class="number">0x65</span>, <span class="number">0x7</span>, <span class="number">0x0</span>, </span><br><span class="line">                 <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x27</span>, <span class="number">0x26</span>, <span class="number">0x2D</span>, <span class="number">0x1</span>, </span><br><span class="line">                 <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x0D</span>, <span class="number">0x56</span>, </span><br><span class="line">                 <span class="number">0x1</span>, <span class="number">0x3</span>, <span class="number">0x65</span>, <span class="number">0x3</span>, </span><br><span class="line">                 <span class="number">0x2D</span>, <span class="number">0x16</span>, <span class="number">0x2</span>, <span class="number">0x15</span>, </span><br><span class="line">                 <span class="number">0x3</span>, <span class="number">0x65</span>, <span class="number">0x0</span>, <span class="number">0x29</span>, </span><br><span class="line">                 <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x1</span>, <span class="number">0x44</span>, </span><br><span class="line">                 <span class="number">0x2B</span>]</span><br><span class="line"></span><br><span class="line">s = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dword_6020c0:</span><br><span class="line">    s = s + str(off_6020a0[i])</span><br><span class="line"></span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
<p>发现不对。注意到有个:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">align 8</span><br></pre></td></tr></table></figure>
<p><img src="http://sz.guiu.xyz/images/2020/02/25/1568826064065.png" alt="1568826064065.png"></p>
<p>这里是“数据对齐”操作。</p>
<p>十六进制下打开可以看到：</p>
<p><img src="http://sz.guiu.xyz/images/2020/02/25/1568826136759.png" alt="1568826136759.png"></p>
<p>0x24和0x05之间插入了一个0x0，于是加回去，getflag：</p>
<p><img src="http://sz.guiu.xyz/images/2020/02/25/1568826359276.png" alt="1568826359276.png"></p>
<hr>
<h1>re4  crackme</h1>
<p>有壳 (nSpack)：</p>
<p><img src="http://sz.guiu.xyz/images/2020/02/25/1568910853160.png" alt="1568910853160.png"></p>
<p>直接上脱壳机：</p>
<p><img src="http://sz.guiu.xyz/images/2020/02/25/1568910949165.png" alt="1568910949165.png"></p>
<p>main函数代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> Buf; <span class="comment">// [esp+4h] [ebp-38h]</span></span><br><span class="line">  <span class="keyword">char</span> Dst; <span class="comment">// [esp+5h] [ebp-37h]</span></span><br><span class="line"></span><br><span class="line">  Buf = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;Dst, <span class="number">0</span>, <span class="number">0x31</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Please Input Flag:"</span>);</span><br><span class="line">  gets_s(&amp;Buf, <span class="number">0x2C</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(&amp;Buf) == <span class="number">42</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = <span class="number">0</span>;					<span class="comment">// byte_402130 = "this_is_not_flag"</span></span><br><span class="line">    <span class="keyword">while</span> ( (*(&amp;Buf + v4) ^ byte_402130[v4 % <span class="number">16</span>]) == dword_402150[v4] ) </span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( ++v4 &gt;= <span class="number">42</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"right!\n"</span>);</span><br><span class="line">        <span class="keyword">goto</span> LABEL_8;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"error!\n"</span>);</span><br><span class="line">LABEL_8:</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"error!\n"</span>);</span><br><span class="line">    result = <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>dump出dword_402150[] 和 byte_402130[]的数据，解密即可：</p>
<p>解密代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">byte_402130 = <span class="string">"this_is_not_flag"</span></span><br><span class="line">dword_402150 = [<span class="number">0x12</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x14</span>,</span><br><span class="line">                <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0x4A</span>, <span class="number">0x3D</span>,</span><br><span class="line">                <span class="number">0x56</span>, <span class="number">0x0A</span>, <span class="number">0x10</span>, <span class="number">0x67</span>,</span><br><span class="line">                <span class="number">0x00</span>, <span class="number">0x41</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">                <span class="number">0x46</span>, <span class="number">0x5A</span>, <span class="number">0x44</span>, <span class="number">0x42</span>,</span><br><span class="line">                <span class="number">0x6E</span>, <span class="number">0x0C</span>, <span class="number">0x44</span>, <span class="number">0x72</span>,</span><br><span class="line">                <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x40</span>, <span class="number">0x3E</span>,</span><br><span class="line">                <span class="number">0x4B</span>, <span class="number">0x5F</span>, <span class="number">0x02</span>, <span class="number">0x01</span>,</span><br><span class="line">                <span class="number">0x4C</span>, <span class="number">0x5E</span>, <span class="number">0x5B</span>, <span class="number">0x17</span>,</span><br><span class="line">                <span class="number">0x6E</span>, <span class="number">0x0C</span>, <span class="number">0x16</span>, <span class="number">0x68</span>,</span><br><span class="line">                <span class="number">0x5B</span>, <span class="number">0x12</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">                <span class="number">0x48</span>]</span><br><span class="line">s = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">42</span>):</span><br><span class="line">    s = s + chr(dword_402150[i] ^ ord(byte_402130[i%<span class="number">16</span>]))</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
<p>flag：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;59b8ed8f-af22-11e7-bb4a-3cf862d1ee75&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1>re5 re-for-50-plz-50</h1>
<p>打开文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">guiu@DESKTOP-EHD7P0U:/mnt/c/Users/HP/Documents/攻防世界逆向$ ./79cb4ed2fa1c41289dce5c9b1d7cc283</span><br><span class="line">-bash: ./79cb4ed2fa1c41289dce5c9b1d7cc283: cannot execute binary file: Exec format error</span><br><span class="line">guiu@DESKTOP-EHD7P0U:/mnt/c/Users/HP/Documents/攻防世界逆向$ file 79cb4ed2fa1c41289dce5c9b1d7cc283</span><br><span class="line">79cb4ed2fa1c41289dce5c9b1d7cc283: ELF 32-bit LSB executable, MIPS, MIPS-II version 1 (SYSV), statically linked, <span class="keyword">for</span> GNU/Linux 2.6.32, BuildID[sha1]=1d5c00adcd4cbb883fea12bc860f827d023e416f, not stripped</span><br><span class="line">guiu@DESKTOP-EHD7P0U:/mnt/c/Users/HP/Documents/攻防世界逆向$</span><br></pre></td></tr></table></figure>
<p>MIPS 指令集，换设备跑一下（我这边用的路由器）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[RT-AC54U /media/AiDisk_a1]<span class="comment"># ./79cb4ed2fa1c41289dce5c9b1d7cc283 </span></span><br><span class="line">Segmentation fault</span><br><span class="line">[RT-AC54U /media/AiDisk_a1]<span class="comment"># ./79cb4ed2fa1c41289dce5c9b1d7cc283 121313</span></span><br><span class="line">NOOOOOOOOOOOOOOOOOO</span><br><span class="line">[RT-AC54U /media/AiDisk_a1]<span class="comment"># ./79cb4ed2fa1c41289dce5c9b1d7cc283 asdasdasdasdasdasdasdasdasdasdasda</span></span><br><span class="line">NOOOOOOOOOOOOOOOOOO</span><br><span class="line">[RT-AC54U /media/AiDisk_a1]<span class="comment">#</span></span><br></pre></td></tr></table></figure>
<p>IDA招呼：</p>
<p><img src="http://sz.guiu.xyz/images/2020/02/25/1568911945157.png" alt="1568911945157.png"></p>
<p>不能反编译,直接读汇编代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">.text:00401398  # int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">.text:00401398                 .globl main</span><br><span class="line">.text:00401398 main:                                    # DATA XREF: sub_40115C+C↑o</span><br><span class="line">.text:00401398                                          # .got:main_ptr↓o</span><br><span class="line">.text:00401398</span><br><span class="line">.text:00401398 var_18          &#x3D; -0x18</span><br><span class="line">.text:00401398 var_10          &#x3D; -0x10</span><br><span class="line">.text:00401398 var_8           &#x3D; -8</span><br><span class="line">.text:00401398 var_4           &#x3D; -4</span><br><span class="line">.text:00401398 arg_0           &#x3D;  0</span><br><span class="line">.text:00401398 arg_4           &#x3D;  4</span><br><span class="line">.text:00401398</span><br><span class="line">.text:00401398                 addiu   $sp, -0x28</span><br><span class="line">.text:0040139C                 sw      $ra, 0x28+var_4($sp)</span><br><span class="line">.text:004013A0                 sw      $fp, 0x28+var_8($sp)</span><br><span class="line">.text:004013A4                 move    $fp, $sp</span><br><span class="line">.text:004013A8                 li      $gp, 0x4AC770</span><br><span class="line">.text:004013B0                 sw      $gp, 0x28+var_18($sp)</span><br><span class="line">.text:004013B4                 sw      $a0, 0x28+arg_0($fp)</span><br><span class="line">.text:004013B8                 sw      $a1, 0x28+arg_4($fp)</span><br><span class="line">.text:004013BC                 sw      $zero, 0x28+var_10($fp)</span><br><span class="line">.text:004013C0                 j       loc_401434</span><br><span class="line">.text:004013C4                 move    $at, $at</span><br><span class="line">.text:004013C8  # ---------------------------------------------------------------------------</span><br><span class="line">.text:004013C8</span><br><span class="line">.text:004013C8 loc_4013C8:                              # CODE XREF: main+A4↓j</span><br><span class="line">.text:004013C8                 lui     $v0, 0x4A</span><br><span class="line">.text:004013CC                 addiu   $v1, $v0, (meow - 0x4A0000)  # &quot;cbtcqLUBChERV[[Nh@_X^D]X_YPV[CJ&quot;</span><br><span class="line">.text:004013D0                 lw      $v0, 0x28+var_10($fp)</span><br><span class="line">.text:004013D4                 addu    $v0, $v1, $v0</span><br><span class="line">.text:004013D8                 lb      $v1, 0($v0)</span><br><span class="line">.text:004013DC                 lw      $v0, 0x28+arg_4($fp)</span><br><span class="line">.text:004013E0                 addiu   $v0, 4</span><br><span class="line">.text:004013E4                 lw      $a0, 0($v0)</span><br><span class="line">.text:004013E8                 lw      $v0, 0x28+var_10($fp)</span><br><span class="line">.text:004013EC                 addu    $v0, $a0, $v0</span><br><span class="line">.text:004013F0                 lb      $v0, 0($v0)</span><br><span class="line">.text:004013F4                 xori    $v0, 0x37		&#x2F;&#x2F; 将前面的字符串和0x37异或</span><br><span class="line">.text:004013F8                 sll     $v0, 24</span><br><span class="line">.text:004013FC                 sra     $v0, 24</span><br><span class="line">.text:00401400                 beq     $v1, $v0, loc_401428</span><br><span class="line">.text:00401404                 move    $at, $at</span><br><span class="line">.text:00401408                 lui     $v0, 0x47</span><br><span class="line">.text:0040140C                 addiu   $a0, $v0, (aNooooooooooooo - 0x470000)  # &quot;NOOOOOOOOOOOOOOOOOO\n&quot;</span><br><span class="line">.text:00401410                 jal     print</span><br><span class="line">.text:00401414                 move    $at, $at</span><br><span class="line">.text:00401418                 lw      $gp, 0x28+var_18($fp)</span><br><span class="line">.text:0040141C                 jal     exit_funct</span><br><span class="line">.text:00401420                 move    $at, $at</span><br><span class="line">.text:00401424                 lw      $gp, 0x28+var_18($fp)</span><br><span class="line">.text:00401428</span><br><span class="line">.text:00401428 loc_401428:                              # CODE XREF: main+68↑j</span><br><span class="line">.text:00401428                 lw      $v0, 0x28+var_10($fp)</span><br><span class="line">.text:0040142C                 addiu   $v0, 1</span><br><span class="line">.text:00401430                 sw      $v0, 0x28+var_10($fp)</span><br><span class="line">.text:00401434</span><br><span class="line">.text:00401434 loc_401434:                              # CODE XREF: main+28↑j</span><br><span class="line">.text:00401434                 lw      $v0, 0x28+var_10($fp)</span><br><span class="line">.text:00401438                 slti    $v0, 0x1F</span><br><span class="line">.text:0040143C                 bnez    $v0, loc_4013C8</span><br><span class="line">.text:00401440                 move    $at, $at</span><br><span class="line">.text:00401444                 lui     $v0, 0x47</span><br><span class="line">.text:00401448                 addiu   $a0, $v0, (aC0ngr4ssulatio - 0x470000)  # &quot;C0ngr4ssulations!! U did it.&quot;</span><br><span class="line">.text:0040144C                 la      $v0, puts</span><br><span class="line">.text:00401450                 move    $t9, $v0</span><br><span class="line">.text:00401454                 jalr    $t9 ; puts</span><br><span class="line">.text:00401458                 move    $at, $at</span><br><span class="line">.text:0040145C                 lw      $gp, 0x28+var_18($fp)</span><br><span class="line">.text:00401460                 jal     exit_funct</span><br><span class="line">.text:00401464                 move    $at, $at</span><br><span class="line">.text:00401468                 lw      $gp, 0x28+var_18($fp)</span><br><span class="line">.text:0040146C                 li      $v0, 1</span><br><span class="line">.text:00401470                 move    $sp, $fp</span><br><span class="line">.text:00401474                 lw      $ra, 0x28+var_4($sp)</span><br><span class="line">.text:00401478                 lw      $fp, 0x28+var_8($sp)</span><br><span class="line">.text:0040147C                 addiu   $sp, 0x28</span><br><span class="line">.text:00401480                 jr      $ra</span><br><span class="line">.text:00401484                 move    $at, $at</span><br><span class="line">.text:00401484  # End of function main</span><br></pre></td></tr></table></figure>
<p>于是解密代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">str1 = <span class="string">"cbtcqLUBChERV[[Nh@_X^D]X_YPV[CJ"</span></span><br><span class="line">print(<span class="string">''</span>.join([chr(<span class="number">0x37</span> ^ ord(s)) <span class="keyword">for</span> s <span class="keyword">in</span> str1]))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TUCTF&#123;but_really_whoisjohngalt&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1>re6 key</h1>
<p>一开始以为sub_4020C0 是关键的比较函数，但是我分析了半天发现不太对，回过头才看到被忽略了的两个关键点。</p>
<p>main()</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">sub_401100</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v0; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v1; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">void</span> **v3; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">void</span> **v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// ST04_4</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// ST08_4</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// ST0C_4</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// ST0C_4</span></span><br><span class="line">  <span class="keyword">char</span> *v11; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">void</span> **v13; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v15; <span class="comment">// ST0C_4</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v17; <span class="comment">// ST0C_4</span></span><br><span class="line">  <span class="keyword">int</span> v18; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v19; <span class="comment">// ST0C_4</span></span><br><span class="line">  <span class="keyword">int</span> v20; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v21; <span class="comment">// ST0C_4</span></span><br><span class="line">  <span class="keyword">int</span> v22; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v23; <span class="comment">// ST0C_4</span></span><br><span class="line">  <span class="keyword">int</span> v24; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v25; <span class="comment">// ST0C_4</span></span><br><span class="line">  <span class="keyword">int</span> v26; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v27; <span class="comment">// ST0C_4</span></span><br><span class="line">  <span class="keyword">int</span> v28; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v30; <span class="comment">// [esp-4h] [ebp-13Ch]</span></span><br><span class="line">  <span class="keyword">int</span> Dst; <span class="comment">// [esp+14h] [ebp-124h]</span></span><br><span class="line">  <span class="keyword">char</span> v32[<span class="number">4</span>]; <span class="comment">// [esp+20h] [ebp-118h]</span></span><br><span class="line">  <span class="keyword">char</span> v33; <span class="comment">// [esp+24h] [ebp-114h]</span></span><br><span class="line">  <span class="keyword">int</span> v34; <span class="comment">// [esp+5Ch] [ebp-DCh]</span></span><br><span class="line">  <span class="keyword">char</span> v35; <span class="comment">// [esp+61h] [ebp-D7h]</span></span><br><span class="line">  <span class="keyword">int</span> v36; <span class="comment">// [esp+64h] [ebp-D4h]</span></span><br><span class="line">  <span class="keyword">int</span> v37; <span class="comment">// [esp+68h] [ebp-D0h]</span></span><br><span class="line">  <span class="keyword">char</span> v38; <span class="comment">// [esp+6Ch] [ebp-CCh]</span></span><br><span class="line">  FILE *<span class="built_in">File</span>; <span class="comment">// [esp+70h] [ebp-C8h]</span></span><br><span class="line">  <span class="keyword">char</span> v40; <span class="comment">// [esp+84h] [ebp-B4h]</span></span><br><span class="line">  <span class="keyword">void</span> *v41; <span class="comment">// [esp+CCh] [ebp-6Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v42; <span class="comment">// [esp+DCh] [ebp-5Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v43; <span class="comment">// [esp+E0h] [ebp-58h]</span></span><br><span class="line">  <span class="keyword">void</span> *v44; <span class="comment">// [esp+E4h] [ebp-54h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v45; <span class="comment">// [esp+F4h] [ebp-44h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v46; <span class="comment">// [esp+F8h] [ebp-40h]</span></span><br><span class="line">  <span class="keyword">void</span> *Memory[<span class="number">4</span>]; <span class="comment">// [esp+FCh] [ebp-3Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v48; <span class="comment">// [esp+10Ch] [ebp-2Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v49; <span class="comment">// [esp+110h] [ebp-28h]</span></span><br><span class="line">  __int128 v50; <span class="comment">// [esp+114h] [ebp-24h]</span></span><br><span class="line">  __int16 v51; <span class="comment">// [esp+124h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">char</span> v52; <span class="comment">// [esp+126h] [ebp-12h]</span></span><br><span class="line">  <span class="keyword">int</span> v53; <span class="comment">// [esp+134h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v46 = <span class="number">15</span>;</span><br><span class="line">  v45 = <span class="number">0</span>;</span><br><span class="line">  LOBYTE(v44) = <span class="number">0</span>;</span><br><span class="line">  v53 = <span class="number">0</span>;</span><br><span class="line">  v43 = <span class="number">15</span>;</span><br><span class="line">  v42 = <span class="number">0</span>;</span><br><span class="line">  LOBYTE(v41) = <span class="number">0</span>;</span><br><span class="line">  LOBYTE(v53) = <span class="number">1</span>;</span><br><span class="line">  v0 = <span class="number">0</span>;</span><br><span class="line">  v48 = <span class="number">1684630885</span>;</span><br><span class="line">  LOWORD(v49) = <span class="number">97</span>;</span><br><span class="line">  *(_OWORD *)Memory = xmmword_40528C;</span><br><span class="line">  v51 = <span class="number">11836</span>;</span><br><span class="line">  v52 = <span class="number">0</span>;</span><br><span class="line">  v50 = xmmword_4052A4;                         <span class="comment">// v50 == "&gt;----++++....&lt;&lt;&lt;&lt;."</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_4021E0(&amp;v41, <span class="number">1u</span>, (*((_BYTE *)Memory + v0) ^ *((_BYTE *)&amp;v50 + v0)) + <span class="number">22</span>);<span class="comment">// 这里才是关键点</span></span><br><span class="line">    ++v0;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v0 &lt; <span class="number">18</span> );</span><br><span class="line">  v1 = <span class="number">0</span>;</span><br><span class="line">  v49 = <span class="number">15</span>;</span><br><span class="line">  v48 = <span class="number">0</span>;</span><br><span class="line">  LOBYTE(Memory[<span class="number">0</span>]) = <span class="number">0</span>;</span><br><span class="line">  LOBYTE(v53) = <span class="number">2</span>;</span><br><span class="line">  v2 = v43;</span><br><span class="line">  v3 = (<span class="keyword">void</span> **)v41;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = &amp;v41;</span><br><span class="line">    <span class="keyword">if</span> ( v2 &gt;= <span class="number">16</span> )</span><br><span class="line">      v4 = v3;</span><br><span class="line">    sub_4021E0(Memory, <span class="number">1u</span>, *((_BYTE *)v4 + v1++) + <span class="number">9</span>);<span class="comment">// 还有这里，遍历+9</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v1 &lt; <span class="number">18</span> );</span><br><span class="line">  <span class="built_in">memset</span>(&amp;Dst, <span class="number">0</span>, <span class="number">184u</span>);                        <span class="comment">// Dst 初始化</span></span><br><span class="line">  sub_401620(&amp;Dst, v5, v6, v7, v8);             <span class="comment">// 关键点 读取flag.txt 在后面比较</span></span><br><span class="line">  LOBYTE(v53) = <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v32[*(_DWORD *)(Dst + <span class="number">4</span>)] &amp; <span class="number">6</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v9 = sub_402A00(<span class="built_in">std</span>::<span class="built_in">cerr</span>, <span class="string">"?W?h?a?t h?a?p?p?e?n?"</span>, sub_402C50);</span><br><span class="line">    <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v9, v10);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_402E90(&amp;Dst, (<span class="keyword">int</span>)&amp;v44);                  <span class="comment">// Dst传到v44，不知道值变了没有，先不管</span></span><br><span class="line">  v11 = &amp;v33;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">File</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !sub_4022F0(&amp;v33) )</span><br><span class="line">      v11 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( fclose(<span class="built_in">File</span>) )</span><br><span class="line">      v11 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v11 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v38 = <span class="number">0</span>;</span><br><span class="line">  v35 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">std</span>::basic_streambuf&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::_Init(&amp;v33);</span><br><span class="line">  v36 = dword_408590;</span><br><span class="line">  <span class="built_in">File</span> = <span class="number">0</span>;</span><br><span class="line">  v37 = dword_408594;</span><br><span class="line">  v34 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !v11 )</span><br><span class="line">    <span class="built_in">std</span>::basic_ios&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::setstate((<span class="keyword">char</span> *)&amp;Dst + *(_DWORD *)(Dst + <span class="number">4</span>), <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  v13 = Memory;</span><br><span class="line">  <span class="keyword">if</span> ( v49 &gt;= <span class="number">0x10</span> )</span><br><span class="line">    v13 = (<span class="keyword">void</span> **)Memory[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">if</span> ( sub_4020C0(&amp;v44, v12, v45, (<span class="keyword">int</span>)v13, v48) )<span class="comment">// 关键点，4020c0为比较flag的函数</span></span><br><span class="line">  &#123;</span><br><span class="line">    v28 = sub_402A00(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"=W=r=o=n=g=K=e=y="</span>, sub_402C50);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v14 = sub_402A00(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"|------------------------------|"</span>, sub_402C50);</span><br><span class="line">    <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v14, v15);</span><br><span class="line">    v16 = sub_402A00(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"|==============================|"</span>, sub_402C50);</span><br><span class="line">    <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v16, v17);</span><br><span class="line">    v18 = sub_402A00(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"|==============================|"</span>, sub_402C50);</span><br><span class="line">    <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v18, v19);</span><br><span class="line">    v20 = sub_402A00(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"|==============================|"</span>, sub_402C50);</span><br><span class="line">    <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v20, v21);</span><br><span class="line">    v22 = sub_402A00(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"\\  /\\  /\\  /\\  /\\==============|"</span>, sub_402C50);</span><br><span class="line">    <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v22, v23);</span><br><span class="line">    v24 = sub_402A00(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">" \\/  \\/  \\/  \\/  \\=============|"</span>, sub_402C50);</span><br><span class="line">    <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v24, v25);</span><br><span class="line">    v26 = sub_402A00(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"                 |-------------|"</span>, sub_402C50);</span><br><span class="line">    <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v26, v27);</span><br><span class="line">    <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::<span class="built_in">cout</span>, sub_402C50);</span><br><span class="line">    v28 = sub_402A00(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"Congrats You got it!"</span>, sub_402C50);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v28, v30);</span><br><span class="line">  sub_401570(&amp;v40);</span><br><span class="line">  <span class="built_in">std</span>::basic_ios&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::~basic_ios&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;v40);</span><br><span class="line">  <span class="keyword">if</span> ( v49 &gt;= <span class="number">0x10</span> )</span><br><span class="line">    sub_402630(Memory[<span class="number">0</span>], v49 + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v2 &gt;= <span class="number">0x10</span> )</span><br><span class="line">    sub_402630(v3, v2 + <span class="number">1</span>);</span><br><span class="line">  result = v46;</span><br><span class="line">  <span class="keyword">if</span> ( v46 &gt;= <span class="number">0x10</span> )</span><br><span class="line">    result = sub_402630(v44, v46 + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>sub_4020C0:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">signed</span> <span class="keyword">int</span> __thiscall <span class="title">sub_4020C0</span><span class="params">(_DWORD *Dst_p, <span class="keyword">int</span> a2, <span class="keyword">unsigned</span> <span class="keyword">int</span> a3, <span class="keyword">int</span> a4, <span class="keyword">unsigned</span> <span class="keyword">int</span> a5)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> flag_p; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v8; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">bool</span> v9; <span class="comment">// cf</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v10; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v11; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v12; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  v5 = a3;</span><br><span class="line">  <span class="keyword">if</span> ( Dst_p[<span class="number">4</span>] &lt; a3 )</span><br><span class="line">    v5 = Dst_p[<span class="number">4</span>];</span><br><span class="line">  <span class="keyword">if</span> ( Dst_p[<span class="number">5</span>] &gt;= <span class="number">16u</span> )</span><br><span class="line">    Dst_p = (_DWORD *)*Dst_p;</span><br><span class="line">  v6 = a5;</span><br><span class="line">  <span class="keyword">if</span> ( v5 &lt; a5 )</span><br><span class="line">    v6 = v5;</span><br><span class="line">  <span class="keyword">if</span> ( v6 )</span><br><span class="line">  &#123;</span><br><span class="line">    flag_p = a4;                                <span class="comment">// flag_p == "themidathemidathemida"</span></span><br><span class="line">    v9 = v6 &lt; <span class="number">4</span>;</span><br><span class="line">    v8 = v6 - <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v9 )</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_11:</span><br><span class="line">      <span class="keyword">if</span> ( v8 == <span class="number">-4</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_20;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( *Dst_p == *(_DWORD *)flag_p )</span><br><span class="line">      &#123;</span><br><span class="line">        ++Dst_p;</span><br><span class="line">        flag_p += <span class="number">4</span>;</span><br><span class="line">        v9 = v8 &lt; <span class="number">4</span>;</span><br><span class="line">        v8 -= <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v9 )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_11;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v9 = *(_BYTE *)Dst_p &lt; *(_BYTE *)flag_p;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)Dst_p != *(_BYTE *)flag_p</span><br><span class="line">      || v8 != <span class="number">-3</span></span><br><span class="line">      &amp;&amp; ((v10 = *((_BYTE *)Dst_p + <span class="number">1</span>), v9 = v10 &lt; *(_BYTE *)(flag_p + <span class="number">1</span>), v10 != *(_BYTE *)(flag_p + <span class="number">1</span>))</span><br><span class="line">       || v8 != <span class="number">-2</span></span><br><span class="line">       &amp;&amp; ((v11 = *((_BYTE *)Dst_p + <span class="number">2</span>), v9 = v11 &lt; *(_BYTE *)(flag_p + <span class="number">2</span>), v11 != *(_BYTE *)(flag_p + <span class="number">2</span>))</span><br><span class="line">        || v8 != <span class="number">-1</span> &amp;&amp; (v12 = *((_BYTE *)Dst_p + <span class="number">3</span>), v9 = v12 &lt; *(_BYTE *)(flag_p + <span class="number">3</span>), v12 != *(_BYTE *)(flag_p + <span class="number">3</span>)))) )</span><br><span class="line">    &#123;</span><br><span class="line">      result = -v9 | <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_21;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_20:</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">LABEL_21:</span><br><span class="line">    <span class="keyword">if</span> ( result )</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 &gt;= a5 )</span><br><span class="line">    result = v5 != a5;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中最为蛋疼的判断部分：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( *(_BYTE *)Dst_p != *(_BYTE *)flag_p</span><br><span class="line">      || v8 != <span class="number">-3</span></span><br><span class="line"><span class="number">1.</span>      &amp;&amp; (</span><br><span class="line">            (v10 = *((_BYTE *)Dst_p + <span class="number">1</span>), v9 = v10 &lt; *(_BYTE *)(flag_p + <span class="number">1</span>), v10 != *(_BYTE *)(flag_p + <span class="number">1</span>))     </span><br><span class="line">                || v8 != <span class="number">-2</span></span><br><span class="line">                    &amp;&amp; (</span><br><span class="line">                        (v11 = *((_BYTE *)Dst_p + <span class="number">2</span>), v9 = v11 &lt; *(_BYTE *)(flag_p + <span class="number">2</span>), v11 != *(_BYTE *)(flag_p + <span class="number">2</span>))</span><br><span class="line">                            || v8 != <span class="number">-1</span> </span><br><span class="line">                                &amp;&amp; (v12 = *((_BYTE *)Dst_p + <span class="number">3</span>), v9 = v12 &lt; *(_BYTE *)(flag_p + <span class="number">3</span>), v12 != *(_BYTE *)(flag_p + <span class="number">3</span>))</span><br><span class="line">                       )</span><br><span class="line">         ) </span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> v8 == <span class="number">-3</span>:</span><br><span class="line">    <span class="number">1.F</span>alse:</span><br><span class="line">        flag_p==Dst_p,</span><br></pre></td></tr></table></figure>
<p>解密脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">memory_byte = <span class="string">"themidathemidathemida"</span></span><br><span class="line">v50 = <span class="string">"&gt;----++++....&lt;&lt;&lt;&lt;."</span></span><br><span class="line">print(<span class="string">''</span>.join([chr((ord(memory_byte[i]) ^ ord(v50[i]))+<span class="number">22</span>+<span class="number">9</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">18</span>)]))</span><br></pre></td></tr></table></figure>
<p>flag:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">idg_cni~bjbfi|gsxb</span><br></pre></td></tr></table></figure>
<hr>
<h1>re7 simple-check-100</h1>
<p>这道题没有做出来不是我的错，是题没出好。</p>
<p>解压出来三个文件：</p>
<p><img src="http://sz.guiu.xyz/images/2020/02/25/1569082454698.png" alt="1569082454698.png"></p>
<p>main():</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">void</span> *v3; <span class="comment">// rsp</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> **v5; <span class="comment">// [rsp+0h] [rbp-60h]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [rsp+Ch] [rbp-54h]</span></span><br><span class="line">  <span class="keyword">char</span> v7; <span class="comment">// [rsp+1Ch] [rbp-44h]</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [rsp+1Dh] [rbp-43h]</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// [rsp+1Eh] [rbp-42h]</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [rsp+1Fh] [rbp-41h]</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// [rsp+20h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">char</span> v12; <span class="comment">// [rsp+21h] [rbp-3Fh]</span></span><br><span class="line">  <span class="keyword">char</span> v13; <span class="comment">// [rsp+22h] [rbp-3Eh]</span></span><br><span class="line">  <span class="keyword">char</span> v14; <span class="comment">// [rsp+23h] [rbp-3Dh]</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// [rsp+24h] [rbp-3Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v16; <span class="comment">// [rsp+25h] [rbp-3Bh]</span></span><br><span class="line">  <span class="keyword">char</span> v17; <span class="comment">// [rsp+26h] [rbp-3Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v18; <span class="comment">// [rsp+27h] [rbp-39h]</span></span><br><span class="line">  <span class="keyword">char</span> v19; <span class="comment">// [rsp+28h] [rbp-38h]</span></span><br><span class="line">  <span class="keyword">char</span> v20; <span class="comment">// [rsp+29h] [rbp-37h]</span></span><br><span class="line">  <span class="keyword">char</span> v21; <span class="comment">// [rsp+2Ah] [rbp-36h]</span></span><br><span class="line">  <span class="keyword">char</span> v22; <span class="comment">// [rsp+2Bh] [rbp-35h]</span></span><br><span class="line">  <span class="keyword">char</span> v23; <span class="comment">// [rsp+2Ch] [rbp-34h]</span></span><br><span class="line">  <span class="keyword">char</span> v24; <span class="comment">// [rsp+2Dh] [rbp-33h]</span></span><br><span class="line">  <span class="keyword">char</span> v25; <span class="comment">// [rsp+2Eh] [rbp-32h]</span></span><br><span class="line">  <span class="keyword">char</span> v26; <span class="comment">// [rsp+2Fh] [rbp-31h]</span></span><br><span class="line">  <span class="keyword">char</span> v27; <span class="comment">// [rsp+30h] [rbp-30h]</span></span><br><span class="line">  <span class="keyword">char</span> v28; <span class="comment">// [rsp+31h] [rbp-2Fh]</span></span><br><span class="line">  <span class="keyword">char</span> v29; <span class="comment">// [rsp+32h] [rbp-2Eh]</span></span><br><span class="line">  <span class="keyword">char</span> v30; <span class="comment">// [rsp+33h] [rbp-2Dh]</span></span><br><span class="line">  <span class="keyword">char</span> v31; <span class="comment">// [rsp+34h] [rbp-2Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v32; <span class="comment">// [rsp+35h] [rbp-2Bh]</span></span><br><span class="line">  <span class="keyword">char</span> v33; <span class="comment">// [rsp+36h] [rbp-2Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v34; <span class="comment">// [rsp+37h] [rbp-29h]</span></span><br><span class="line">  __int64 v35; <span class="comment">// [rsp+38h] [rbp-28h]</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> ***v36; <span class="comment">// [rsp+40h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v37; <span class="comment">// [rsp+48h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v6 = argc;</span><br><span class="line">  v5 = argv;</span><br><span class="line">  v37 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v7 = <span class="number">84</span>;</span><br><span class="line">  v8 = <span class="number">-56</span>;</span><br><span class="line">  v9 = <span class="number">126</span>;</span><br><span class="line">  v10 = <span class="number">-29</span>;</span><br><span class="line">  v11 = <span class="number">100</span>;</span><br><span class="line">  v12 = <span class="number">-57</span>;</span><br><span class="line">  v13 = <span class="number">22</span>;</span><br><span class="line">  v14 = <span class="number">-102</span>;</span><br><span class="line">  v15 = <span class="number">-51</span>;</span><br><span class="line">  v16 = <span class="number">17</span>;</span><br><span class="line">  v17 = <span class="number">101</span>;</span><br><span class="line">  v18 = <span class="number">50</span>;</span><br><span class="line">  v19 = <span class="number">45</span>;</span><br><span class="line">  v20 = <span class="number">-29</span>;</span><br><span class="line">  v21 = <span class="number">-45</span>;</span><br><span class="line">  v22 = <span class="number">67</span>;</span><br><span class="line">  v23 = <span class="number">-110</span>;</span><br><span class="line">  v24 = <span class="number">-87</span>;</span><br><span class="line">  v25 = <span class="number">-99</span>;</span><br><span class="line">  v26 = <span class="number">-46</span>;</span><br><span class="line">  v27 = <span class="number">-26</span>;</span><br><span class="line">  v28 = <span class="number">109</span>;</span><br><span class="line">  v29 = <span class="number">44</span>;</span><br><span class="line">  v30 = <span class="number">-45</span>;</span><br><span class="line">  v31 = <span class="number">-74</span>;</span><br><span class="line">  v32 = <span class="number">-67</span>;</span><br><span class="line">  v33 = <span class="number">-2</span>;</span><br><span class="line">  v34 = <span class="number">106</span>;</span><br><span class="line">  v35 = <span class="number">19L</span>L;</span><br><span class="line">  v3 = alloca(<span class="number">32L</span>L);</span><br><span class="line">  v36 = &amp;v5;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Key: "</span>, argv, <span class="number">3L</span>L, <span class="number">16L</span>L, <span class="number">20L</span>L, <span class="number">0L</span>L, argv);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%s"</span>, v36);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)check_key((__int64)v36) )</span><br><span class="line">    interesting_function((__int64)&amp;v7);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Wrong"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>逻辑太简单，都不想写注释。</p>
<p>check_key():</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_BOOL8 __fastcall <span class="title">check_key</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [rsp+8h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+Ch] [rbp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">    v2 += *(_DWORD *)(<span class="number">4L</span>L * i + a1);</span><br><span class="line">  <span class="keyword">return</span> v2 == <span class="number">-559038737</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>明显是个坑人的函数，v2恒为false，所以不会进入到下面的interesting_funstion()</p>
<p>那么再看看intersting_function()：</p>
<p>interesting_function():</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __fastcall <span class="title">interesting_function</span><span class="params">(__int64 a1)</span>		<span class="comment">// a1 == 84</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> *v1; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// [rsp+1Ch] [rbp-24h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+20h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [rsp+24h] [rbp-1Ch]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v8; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  LODWORD(v1) = a1;</span><br><span class="line">  v6 = a1;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">6</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = *(_DWORD *)(<span class="number">4L</span>L * i + v6) ^ <span class="number">0xDEADBEEF</span>;</span><br><span class="line">    v1 = (<span class="keyword">int</span> *)&amp;v3;</span><br><span class="line">    v7 = (<span class="keyword">int</span> *)&amp;v3;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">3</span>; j &gt;= <span class="number">0</span>; --j )</span><br><span class="line">      LODWORD(v1) = <span class="built_in">putchar</span>((<span class="keyword">char</span>)(*((_BYTE *)v7 + j) ^ flag_data[<span class="number">4</span> * i + j]));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">signed</span> <span class="keyword">int</span>)v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>a1是个常量，所以这个函数输出的也是个定值。到这里其实思路很明显了，修改标志位让程序进入这个函数得到flag就可以了，而我也这么做了，但是输出来的却是一串乱码……</p>
<p>那我就不干了，然后手动把这个函数实现了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">flag_data = [</span><br><span class="line">    <span class="number">0xDC</span>, <span class="number">0x17</span>, <span class="number">0xBF</span>, <span class="number">0x5B</span>, <span class="number">0xD4</span>, <span class="number">0x0A</span>, <span class="number">0xD2</span>, <span class="number">0x1B</span>, <span class="number">0x7D</span>, <span class="number">0xDA</span>,</span><br><span class="line">    <span class="number">0xA7</span>, <span class="number">0x95</span>, <span class="number">0xB5</span>, <span class="number">0x32</span>, <span class="number">0x10</span>, <span class="number">0xF6</span>, <span class="number">0x1C</span>, <span class="number">0x65</span>, <span class="number">0x53</span>, <span class="number">0x53</span>,</span><br><span class="line">    <span class="number">0x67</span>, <span class="number">0xBA</span>, <span class="number">0xEA</span>, <span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x22</span>, <span class="number">0x72</span>, <span class="number">0xD3</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">v4 = <span class="number">84</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">    v2 = (<span class="number">4</span>*i*v4) ^ <span class="number">0xDEADBEEF</span></span><br><span class="line">    result = int(v2)</span><br><span class="line">    v3 = int(v2)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>]:</span><br><span class="line">        temp = (v3 + j) ^ flag_data[<span class="number">4</span> * i + j]</span><br><span class="line">        flag += chr(temp)</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p>然鹅：</p>
<p><img src="http://sz.guiu.xyz/images/2020/02/25/1569082817612.png" alt="1569082817612.png"></p>
<p>沃妮马都不知道多大的数了，其实口算一下都知道不可能是字符的。</p>
<p>到这里我的思路断了，于是把main函数仅有的几行代码翻来覆去的看，要不是这个题实在太简单我甚至要怀疑我是不是学了假的c语言……</p>
<p>然后去看了别人的writeup，发现别人用exe也做不出来……</p>
<p>然后把目光放在了一开始给的其他版本文件上。</p>
<p>打开EDB调试那个64位的ELF文件，下断点改标志位进入分支：</p>
<p><img src="http://sz.guiu.xyz/images/2020/02/25/1569083871879.png" alt="1569083871879.png"></p>
<p>顺利拿到flag：</p>
<p><img src="http://sz.guiu.xyz/images/2020/02/25/1569083952906.png" alt="1569083952906.png"></p>
<p>flag:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag_is_you_know_cracking!!!</span><br></pre></td></tr></table></figure>
<hr>
<h1>re8 re1-100</h1>
<p>也很简单，过程都在注释里了</p>
<p>main()：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl __noreturn <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">__pid_t</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">size_t</span> v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">ssize_t</span> v5; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">bool</span> v6; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> **v7; <span class="comment">// [rsp+0h] [rbp-1D0h]</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [rsp+13h] [rbp-1BDh]</span></span><br><span class="line">  <span class="keyword">ssize_t</span> v9; <span class="comment">// [rsp+18h] [rbp-1B8h]</span></span><br><span class="line">  <span class="keyword">ssize_t</span> v10; <span class="comment">// [rsp+18h] [rbp-1B8h]</span></span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+20h] [rbp-1B0h]</span></span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">200</span>]; <span class="comment">// [rsp+F0h] [rbp-E0h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v13; <span class="comment">// [rsp+1B8h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v7 = argv;</span><br><span class="line">  v13 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v8 = (<span class="keyword">unsigned</span> __int8)detectDebugging();</span><br><span class="line">  <span class="keyword">if</span> ( pipe(pParentWrite) == <span class="number">-1</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( pipe(pParentRead) == <span class="number">-1</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  v3 = fork();</span><br><span class="line">  <span class="keyword">if</span> ( v3 != <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v3 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">close</span>(pParentWrite[<span class="number">0</span>]);</span><br><span class="line">      <span class="built_in">close</span>(dword_6DA554);</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Input key : "</span>, v7);</span><br><span class="line">        <span class="built_in">memset</span>(&amp;buf, <span class="string">'\0'</span>, <span class="number">200u</span>LL);</span><br><span class="line">        gets(&amp;buf, <span class="string">'\0'</span>);</span><br><span class="line">        v4 = <span class="built_in">strlen</span>(&amp;buf);</span><br><span class="line">        v5 = <span class="built_in">write</span>(fd, &amp;buf, v4);               <span class="comment">// 将输入的buf值写入fd</span></span><br><span class="line">        <span class="keyword">if</span> ( v5 != <span class="built_in">strlen</span>(&amp;buf) )</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">"parent - partial/failed write"</span>, &amp;buf);</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">200u</span>LL);</span><br><span class="line">          v10 = <span class="built_in">read</span>(pParentRead[<span class="number">0</span>], s, <span class="number">200u</span>LL);<span class="comment">// 从pParentRead[]中读200个字符到s数组</span></span><br><span class="line">          v6 = (_BYTE)v8 || (<span class="keyword">unsigned</span> __int8)checkDebuggerProcessRunning();</span><br><span class="line">          <span class="keyword">if</span> ( v6 )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"Wrong !!!\n"</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)checkStringIsNumber(s) ^ <span class="number">1</span> )<span class="comment">// 要求不是数字</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"Wrong !!!\n"</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( atoi(s) )                      <span class="comment">// atoi函数把字符串转换成整型数</span></span><br><span class="line">            &#123;</span><br><span class="line">              <span class="built_in">puts</span>(<span class="string">"True"</span>);</span><br><span class="line">              <span class="keyword">if</span> ( <span class="built_in">close</span>(fd) == <span class="number">-1</span> )</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">              <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"Wrong !!!\n"</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( v10 == <span class="number">-1</span> );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">close</span>(fd);</span><br><span class="line">    <span class="built_in">close</span>(pParentRead[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">200u</span>LL);</span><br><span class="line">      v9 = <span class="built_in">read</span>(pParentWrite[<span class="number">0</span>], s, <span class="number">200u</span>LL);</span><br><span class="line">      <span class="keyword">if</span> ( v9 == <span class="number">-1</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v9 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)childCheckDebugResult() )</span><br><span class="line">        &#123;</span><br><span class="line">          responseFalse();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( s[<span class="number">0</span>] == <span class="string">'&#123;'</span> )                 <span class="comment">// &#123;53fc275d81&#123;len(20)&#125;4938ae4efd</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( <span class="built_in">strlen</span>(s) == <span class="number">42</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(&amp;s[<span class="number">1</span>], <span class="string">"53fc275d81"</span>, <span class="number">10u</span>LL) )<span class="comment">// 1-10: '53fc275d81'</span></span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">if</span> ( s[<span class="built_in">strlen</span>(s) - <span class="number">1</span>] == <span class="string">'&#125;'</span> )    <span class="comment">// 以'&#125;'结尾</span></span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(&amp;s[<span class="number">31</span>], <span class="string">"4938ae4efd"</span>, <span class="number">10u</span>LL) )<span class="comment">// 31-40: '4938ae4efd'</span></span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)confuseKey(s, <span class="number">42</span>) ^ <span class="number">1</span> )		<span class="comment">//将s交换顺序，1234 --&gt; 3412</span></span><br><span class="line">                  &#123;</span><br><span class="line">                    responseFalse();</span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="keyword">else</span> <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(s, <span class="string">"&#123;daf29f59034938ae4efd53fc275d81053ed5be8c&#125;"</span>, <span class="number">42u</span>LL) )<span class="comment">// 交换完顺序之后要是这个</span></span><br><span class="line">                  &#123;</span><br><span class="line">                    responseTrue();</span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="keyword">else</span></span><br><span class="line">                  &#123;</span><br><span class="line">                    responseFalse();</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                  responseFalse();</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">else</span></span><br><span class="line">              &#123;</span><br><span class="line">                responseFalse();</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">              responseFalse();</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            responseFalse();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          responseFalse();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>confuseKey()：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">confuseKey</span><span class="params">(<span class="keyword">char</span> *a1_s, <span class="keyword">int</span> a2_42)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> dest[<span class="number">8</span>]; <span class="comment">// [rsp+10h] [rbp-50h]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [rsp+18h] [rbp-48h]</span></span><br><span class="line">  __int16 v5; <span class="comment">// [rsp+1Ch] [rbp-44h]</span></span><br><span class="line">  <span class="keyword">char</span> v6; <span class="comment">// [rsp+1Eh] [rbp-42h]</span></span><br><span class="line">  <span class="keyword">char</span> v7[<span class="number">8</span>]; <span class="comment">// [rsp+20h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [rsp+28h] [rbp-38h]</span></span><br><span class="line">  __int16 v9; <span class="comment">// [rsp+2Ch] [rbp-34h]</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [rsp+2Eh] [rbp-32h]</span></span><br><span class="line">  <span class="keyword">char</span> v11[<span class="number">8</span>]; <span class="comment">// [rsp+30h] [rbp-30h]</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// [rsp+38h] [rbp-28h]</span></span><br><span class="line">  __int16 v13; <span class="comment">// [rsp+3Ch] [rbp-24h]</span></span><br><span class="line">  <span class="keyword">char</span> v14; <span class="comment">// [rsp+3Eh] [rbp-22h]</span></span><br><span class="line">  <span class="keyword">char</span> v15[<span class="number">8</span>]; <span class="comment">// [rsp+40h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// [rsp+48h] [rbp-18h]</span></span><br><span class="line">  __int16 v17; <span class="comment">// [rsp+4Ch] [rbp-14h]</span></span><br><span class="line">  <span class="keyword">char</span> v18; <span class="comment">// [rsp+4Eh] [rbp-12h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v19; <span class="comment">// [rsp+58h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v19 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  *(_QWORD *)dest = <span class="number">0L</span>L;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  *(_QWORD *)v7 = <span class="number">0L</span>L;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  *(_QWORD *)v11 = <span class="number">0L</span>L;</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  v13 = <span class="number">0</span>;</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  *(_QWORD *)v15 = <span class="number">0L</span>L;</span><br><span class="line">  v16 = <span class="number">0</span>;</span><br><span class="line">  v17 = <span class="number">0</span>;</span><br><span class="line">  v18 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2_42 != <span class="number">42</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( !a1_s )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(a1_s) != <span class="number">42</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">if</span> ( *a1_s != <span class="string">'&#123;'</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="built_in">strncpy</span>(dest, a1_s + <span class="number">1</span>, <span class="number">10u</span>LL);               <span class="comment">// s前十位至dest</span></span><br><span class="line">  <span class="built_in">strncpy</span>(v7, a1_s + <span class="number">11</span>, <span class="number">10u</span>LL);                <span class="comment">// 11-20位至v7</span></span><br><span class="line">  <span class="built_in">strncpy</span>(v11, a1_s + <span class="number">21</span>, <span class="number">0xA</span>uLL);              <span class="comment">// 21-30位至v11</span></span><br><span class="line">  <span class="built_in">strncpy</span>(v15, a1_s + <span class="number">31</span>, <span class="number">0xA</span>uLL);              <span class="comment">// 31-40位至v15</span></span><br><span class="line">  <span class="built_in">memset</span>(a1_s, <span class="number">0</span>, a2_42);                       <span class="comment">// 把s清空</span></span><br><span class="line">  *a1_s = <span class="number">123</span>;</span><br><span class="line">  <span class="built_in">strcat</span>(a1_s, v11);                            <span class="comment">// 1234 --&gt; 3412</span></span><br><span class="line">  <span class="built_in">strcat</span>(a1_s, v15);</span><br><span class="line">  <span class="built_in">strcat</span>(a1_s, dest);</span><br><span class="line">  <span class="built_in">strcat</span>(a1_s, v7);</span><br><span class="line">  a1_s[<span class="number">41</span>] = <span class="string">'&#125;'</span>;                               <span class="comment">// 再赋值给s</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>交换一下顺序即可，flag为：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">53fc275d81053ed5be8cdaf29f59034938ae4efd</span><br></pre></td></tr></table></figure>
<hr>
<h1>re9 The_Maya_Society</h1>
<p>这个题有点脑洞，打开有个网页Maya society，然后有个elf文件。</p>
<p>IDA打开很容易发现main函数逻辑，经过分析，主要功能是md5加密当前时间，然后拼接后面的 “.fluxfingers.net” 字符串，请求拼接好的域名的DNS TXT解析记录，然后base64解码，再与0x25异或即为flag。</p>
<p>请求中间有个sub_18A4函数开始没看懂，最后才知道应该是网络通信相关的函数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">signed</span> __int64 __fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> v3; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">size_t</span> v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v6; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v7; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v8; <span class="comment">// rsi</span></span><br><span class="line">  <span class="keyword">char</span> *v9; <span class="comment">// rdi</span></span><br><span class="line">  <span class="keyword">time_t</span> timer; <span class="comment">// [rsp+18h] [rbp-128h]</span></span><br><span class="line">  <span class="keyword">char</span> v11[<span class="number">8</span>]; <span class="comment">// [rsp+20h] [rbp-120h]</span></span><br><span class="line">  <span class="keyword">char</span> src; <span class="comment">// [rsp+40h] [rbp-100h]</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+60h] [rbp-E0h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v14; <span class="comment">// [rsp+C8h] [rbp-78h]</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// [rsp+D4h] [rbp-6Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v16; <span class="comment">// [rsp+DDh] [rbp-63h]</span></span><br><span class="line">  <span class="keyword">char</span> v17; <span class="comment">// [rsp+E6h] [rbp-5Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v18; <span class="comment">// [rsp+EFh] [rbp-51h]</span></span><br><span class="line">  <span class="keyword">char</span> *v19; <span class="comment">// [rsp+F8h] [rbp-48h]</span></span><br><span class="line">  <span class="keyword">char</span> *v20; <span class="comment">// [rsp+100h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">char</span> *v21; <span class="comment">// [rsp+108h] [rbp-38h]</span></span><br><span class="line">  <span class="keyword">char</span> *dest; <span class="comment">// [rsp+110h] [rbp-30h]</span></span><br><span class="line">  <span class="keyword">int</span> *v23; <span class="comment">// [rsp+118h] [rbp-28h]</span></span><br><span class="line">  <span class="keyword">size_t</span> v24; <span class="comment">// [rsp+120h] [rbp-20h]</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">tm</span> *<span class="title">tp</span>;</span> <span class="comment">// [rsp+128h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(v11, <span class="string">".fluxfingers.net"</span>);</span><br><span class="line">  timer = time(<span class="number">0L</span>L);</span><br><span class="line">  tp = localtime(&amp;timer);</span><br><span class="line">  strftime(&amp;s, <span class="number">99u</span>LL, <span class="string">"%Y-%m-%d"</span>, tp);</span><br><span class="line">  v24 = <span class="built_in">strlen</span>(&amp;s);</span><br><span class="line">  md5_func(&amp;s, v24);                            <span class="comment">// md5加密当前时间，得到的几组数为md5算法输出的级联</span></span><br><span class="line">  v23 = (<span class="keyword">int</span> *)&amp;qword_2030B8;</span><br><span class="line">  <span class="built_in">snprintf</span>(</span><br><span class="line">    &amp;v18,</span><br><span class="line">    <span class="number">9u</span>LL,</span><br><span class="line">    <span class="string">"%02x%02x%02x%02x"</span>,</span><br><span class="line">    (<span class="keyword">unsigned</span> __int8)qword_2030B8,              <span class="comment">// 这几个数字是md5的标志 A,B,C,D</span></span><br><span class="line">    BYTE1(qword_2030B8),</span><br><span class="line">    BYTE2(qword_2030B8),</span><br><span class="line">    BYTE3(qword_2030B8));</span><br><span class="line">  v23 = &amp;dword_2030C0;</span><br><span class="line">  <span class="built_in">snprintf</span>(</span><br><span class="line">    &amp;v17,</span><br><span class="line">    <span class="number">9u</span>LL,</span><br><span class="line">    <span class="string">"%02x%02x%02x%02x"</span>,</span><br><span class="line">    (<span class="keyword">unsigned</span> __int8)dword_2030C0,</span><br><span class="line">    BYTE1(dword_2030C0),</span><br><span class="line">    BYTE2(dword_2030C0),</span><br><span class="line">    HIBYTE(dword_2030C0));</span><br><span class="line">  v23 = &amp;dword_2030B4;</span><br><span class="line">  <span class="built_in">snprintf</span>(</span><br><span class="line">    &amp;v16,</span><br><span class="line">    <span class="number">9u</span>LL,</span><br><span class="line">    <span class="string">"%02x%02x%02x%02x"</span>,</span><br><span class="line">    (<span class="keyword">unsigned</span> __int8)dword_2030B4,</span><br><span class="line">    BYTE1(dword_2030B4),</span><br><span class="line">    BYTE2(dword_2030B4),</span><br><span class="line">    HIBYTE(dword_2030B4));</span><br><span class="line">  v23 = (<span class="keyword">int</span> *)((<span class="keyword">char</span> *)&amp;qword_2030B8 + <span class="number">4</span>);</span><br><span class="line">  <span class="built_in">snprintf</span>(</span><br><span class="line">    &amp;v15,</span><br><span class="line">    <span class="number">9u</span>LL,</span><br><span class="line">    <span class="string">"%02x%02x%02x%02x"</span>,</span><br><span class="line">    BYTE4(qword_2030B8),</span><br><span class="line">    BYTE5(qword_2030B8),</span><br><span class="line">    BYTE6(qword_2030B8),</span><br><span class="line">    HIBYTE(qword_2030B8));</span><br><span class="line">  <span class="built_in">snprintf</span>(&amp;src, <span class="number">33u</span>LL, <span class="string">"%s%s%s%s"</span>, &amp;v18, &amp;v17, &amp;v16, &amp;v15);<span class="comment">// src为md5加密后的结果</span></span><br><span class="line">  v3 = <span class="built_in">strlen</span>(&amp;src);</span><br><span class="line">  v4 = <span class="built_in">strlen</span>(v11);</span><br><span class="line">  dest = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(v3 + v4 + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !dest )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">  *dest = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">strcat</span>(dest, &amp;src);                           <span class="comment">// 连接src和v11，组成新字符串</span></span><br><span class="line">  <span class="built_in">strcat</span>(dest, v11);                            <span class="comment">// v11 == ".fluxfingers.net"</span></span><br><span class="line">  v21 = sub_18A4(dest);                         <span class="comment">// 这个函数暂时没搞懂干啥的</span></span><br><span class="line">  <span class="keyword">if</span> ( !v21 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">  v6 = <span class="built_in">strlen</span>(v21);</span><br><span class="line">  v20 = base64((__int64)v21, v6, &amp;v14);         <span class="comment">// base64解码</span></span><br><span class="line">  v7 = <span class="built_in">strlen</span>(v21);</span><br><span class="line">  v19 = base64((__int64)v21, v7, &amp;v14);</span><br><span class="line">  <span class="keyword">if</span> ( !v20 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">  v8 = v14;</span><br><span class="line">  v9 = v20;</span><br><span class="line">  sub_1858((__int64)v20, v14, (__int64)v19);    <span class="comment">// 又异或了一波</span></span><br><span class="line">  ((<span class="keyword">void</span> (__fastcall *)(<span class="keyword">char</span> *, <span class="keyword">unsigned</span> __int64))v19)(v9, v8);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>sub_1858：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> __int64 __fastcall <span class="title">sub_1858</span><span class="params">(__int64 a1, <span class="keyword">unsigned</span> __int64 a2, __int64 a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 i; <span class="comment">// [rsp+20h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0L</span>L; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= a2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(a3 + i) = *(_BYTE *)(a1 + i) ^ <span class="number">0x25</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>sub_18A4:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> *__fastcall <span class="title">sub_18A4</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v2; <span class="comment">// rax</span></span><br><span class="line">  ns_rr v3; <span class="comment">// [rsp+10h] [rbp-24A0h]</span></span><br><span class="line">  ns_msg v4; <span class="comment">// [rsp+430h] [rbp-2080h]</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+480h] [rbp-2030h]</span></span><br><span class="line">  u_char v6; <span class="comment">// [rsp+1480h] [rbp-1030h]</span></span><br><span class="line">  <span class="keyword">char</span> *dest; <span class="comment">// [rsp+2488h] [rbp-28h]</span></span><br><span class="line">  <span class="keyword">size_t</span> n; <span class="comment">// [rsp+2490h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">char</span> *v9; <span class="comment">// [rsp+2498h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">char</span> *src; <span class="comment">// [rsp+24A0h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [rsp+24ACh] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v11 = __res_query(a1, <span class="number">1</span>, <span class="number">16</span>, &amp;v6, <span class="number">4096</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v11 &lt; <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  ns_initparse(&amp;v6, v11, &amp;v4);</span><br><span class="line">  v11 = v4._counts[<span class="number">1</span>];</span><br><span class="line">  ns_parserr(&amp;v4, ns_s_an, <span class="number">0</span>, &amp;v3);</span><br><span class="line">  ns_sprintrr(&amp;v4, &amp;v3, <span class="number">0L</span>L, <span class="number">0L</span>L, &amp;s, <span class="number">0x1000</span>uLL);</span><br><span class="line">  v2 = <span class="built_in">strchr</span>(&amp;s, <span class="number">34</span>);</span><br><span class="line">  src = v2 + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v2 == (<span class="keyword">char</span> *)<span class="number">-1L</span>L )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  v9 = <span class="built_in">strchr</span>(src, <span class="number">34</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !v9 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  n = v9 - src;</span><br><span class="line">  dest = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(v9 - src + <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">strncpy</span>(dest, src, n);</span><br><span class="line">  dest[n] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>参考别人的解释：</p>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>函数原型</strong></th>
<th style="text-align:center"><strong>作用</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">int res_query(const char *dname, int class, int type,unsigned char *answer,int anslen)</td>
<td style="text-align:center">查询名称服务器，以获得指定类型和类的完全限定域名。应答保留在调用方提供的<code>anslen</code>长度的缓冲区应答中</td>
</tr>
<tr>
<td style="text-align:center">int ns_initparse(const u_char *msg, int msglen, ns_msg *handle)</td>
<td style="text-align:center">在使用其他名称服务器库例程之前必须调用的第一个例程。nitparse填充句柄指向的数据结构，该句柄是传递给其他例程的参数</td>
</tr>
<tr>
<td style="text-align:center">int ns_parserr(ns_msg *handle, ns_sect section, int rrnum, ns_rr *rr)</td>
<td style="text-align:center">提取关于响应记录的信息并将其存储在rr中，rr是传递给其他名称服务器库例程的参数</td>
</tr>
<tr>
<td style="text-align:center">int ns_sprintrr(const ns_msg *handle, const ns_rr *rr, const char *name_ctx, const char *origin, char *buf, size_t buflen)</td>
<td style="text-align:center">将rr转换为表示格式</td>
</tr>
</tbody>
</table>
<p>开始没搞懂sub_18A4函数的功能，查询后是跟通信相关的函数，于是抓了个包，同时也验证了一下之前逆向的思路是否正确。</p>
<p><img src="http://sz.guiu.xyz/images/2020/02/25/1569250903863.png" alt="1569250903863.png"></p>
<p>可以看到是拼接后再查TXT解析记录。</p>
<p>明确了思路，那么拿到TXT解析记录再解码就完事了:</p>
<p><img src="http://sz.guiu.xyz/images/2020/02/25/1569250467584.png" alt="1569250467584.png"></p>
<p>照样写了个解码脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> dns.resolver</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">init_str = <span class="string">".fluxfingers.net"</span></span><br><span class="line">time = <span class="string">b"2012-12-21"</span></span><br><span class="line">time_hash = hashlib.md5(time)</span><br><span class="line"></span><br><span class="line">domin = time_hash.hexdigest() + init_str</span><br><span class="line"><span class="comment"># domin = "a0ab7eafc534bc4a8a48cd6e1cfc4d24.fluxfingers.net"</span></span><br><span class="line">TXT = dns.resolver.query(domin, <span class="string">'TXT'</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> TXT:</span><br><span class="line">    <span class="keyword">if</span> i.strings[<span class="number">0</span>]:</span><br><span class="line">        strs = i.strings[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> base64.decodebytes(strs):</span><br><span class="line">            flag += chr(j ^ <span class="number">0x25</span>)</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p>说下这里的2012-12-21的思路问题：</p>
<p>开始打开题目给的网页的时候，发现好像跟题目无关，于是就瞟了一下，记住了2012和玛雅文明，逆到md5部分发现跟时间有关，于是想到了时间肯定是一个特定值，于是想到了2012，都要爆破了，然后查sub_18A4函数的时候看到了别人的writeup，知道是2012-12-21，于是就没有爆破了，只能说这个点确实有点脑洞。</p>
<p>解码结果：</p>
<p><img src="http://sz.guiu.xyz/images/2020/02/25/1569250997311.png" alt="1569250997311.png"></p>
<p>flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;e3a03c6f3fe91b40eaa8e71b41f0db12&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1>re10 srm-50</h1>
<p>这个题……</p>
<p>完全对不起他的分数好吗！！！</p>
<p>main()：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL __stdcall <span class="title">DialogFunc</span><span class="params">(HWND hDlg, UINT a2, WPARAM a3, LPARAM a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  HMODULE v5; <span class="comment">// eax</span></span><br><span class="line">  HICON v6; <span class="comment">// eax</span></span><br><span class="line">  HMODULE v7; <span class="comment">// eax</span></span><br><span class="line">  HCURSOR v8; <span class="comment">// ST20_4</span></span><br><span class="line">  HWND v9; <span class="comment">// eax</span></span><br><span class="line">  CHAR <span class="keyword">String</span>; <span class="comment">// [esp+8h] [ebp-340h]</span></span><br><span class="line">  CHAR v11[<span class="number">4</span>]; <span class="comment">// [esp+108h] [ebp-240h]</span></span><br><span class="line">  <span class="keyword">char</span> v12; <span class="comment">// [esp+10Ch] [ebp-23Ch] //从这里寄存器的位置来看，v12-v23是连续的，所以后面组合后的注册码顺序也要是这个</span></span><br><span class="line">  <span class="keyword">char</span> v13; <span class="comment">// [esp+10Dh] [ebp-23Bh]</span></span><br><span class="line">  <span class="keyword">char</span> v14; <span class="comment">// [esp+10Eh] [ebp-23Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// [esp+10Fh] [ebp-239h]</span></span><br><span class="line">  <span class="keyword">char</span> v16; <span class="comment">// [esp+110h] [ebp-238h]</span></span><br><span class="line">  <span class="keyword">char</span> v17; <span class="comment">// [esp+111h] [ebp-237h]</span></span><br><span class="line">  <span class="keyword">char</span> v18; <span class="comment">// [esp+112h] [ebp-236h]</span></span><br><span class="line">  <span class="keyword">char</span> v19; <span class="comment">// [esp+113h] [ebp-235h]</span></span><br><span class="line">  <span class="keyword">char</span> v20; <span class="comment">// [esp+114h] [ebp-234h]</span></span><br><span class="line">  <span class="keyword">char</span> v21; <span class="comment">// [esp+115h] [ebp-233h]</span></span><br><span class="line">  <span class="keyword">char</span> v22; <span class="comment">// [esp+116h] [ebp-232h]</span></span><br><span class="line">  <span class="keyword">char</span> v23; <span class="comment">// [esp+117h] [ebp-231h]</span></span><br><span class="line">  CHAR Text; <span class="comment">// [esp+208h] [ebp-140h]</span></span><br><span class="line">  <span class="keyword">char</span> Src[<span class="number">16</span>]; <span class="comment">// [esp+308h] [ebp-40h]</span></span><br><span class="line">  __int128 v26; <span class="comment">// [esp+318h] [ebp-30h]</span></span><br><span class="line">  <span class="keyword">int</span> v27; <span class="comment">// [esp+328h] [ebp-20h]</span></span><br><span class="line">  __int128 v28; <span class="comment">// [esp+32Ch] [ebp-1Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v29; <span class="comment">// [esp+33Ch] [ebp-Ch]</span></span><br><span class="line">  __int16 v30; <span class="comment">// [esp+340h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a2 == <span class="number">16</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    EndDialog(hDlg, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( a2 == <span class="number">272</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = GetModuleHandleW(<span class="number">0</span>);</span><br><span class="line">    v6 = LoadIconW(v5, (LPCWSTR)<span class="number">0x67</span>);</span><br><span class="line">    SetClassLongA(hDlg, <span class="number">-14</span>, (LONG)v6);</span><br><span class="line">    v7 = GetModuleHandleW(<span class="number">0</span>);</span><br><span class="line">    v8 = LoadCursorW(v7, (LPCWSTR)<span class="number">0x66</span>);</span><br><span class="line">    v9 = GetDlgItem(hDlg, <span class="number">1</span>);</span><br><span class="line">    SetClassLongA(v9, <span class="number">-12</span>, (LONG)v8);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( a2 != <span class="number">273</span> || (<span class="keyword">unsigned</span> __int16)a3 != <span class="number">1</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;<span class="keyword">String</span>, (<span class="keyword">unsigned</span> __int16)a3 - <span class="number">1</span>, <span class="number">0x100</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(v11, <span class="number">0</span>, <span class="number">0x100</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;Text, <span class="number">0</span>, <span class="number">0x100</span>u);</span><br><span class="line">  GetDlgItemTextA(hDlg, <span class="number">1001</span>, &amp;<span class="keyword">String</span>, <span class="number">256</span>);</span><br><span class="line">  GetDlgItemTextA(hDlg, <span class="number">1002</span>, v11, <span class="number">256</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strstr</span>(&amp;<span class="keyword">String</span>, <span class="string">"@"</span>) &amp;&amp; <span class="built_in">strstr</span>(&amp;<span class="keyword">String</span>, <span class="string">"."</span>) &amp;&amp; <span class="built_in">strstr</span>(&amp;<span class="keyword">String</span>, <span class="string">"."</span>)[<span class="number">1</span>] &amp;&amp; <span class="built_in">strstr</span>(&amp;<span class="keyword">String</span>, <span class="string">"@"</span>)[<span class="number">1</span>] != <span class="string">'.'</span> )<span class="comment">// email的信息未指定，符合条件即可，也不参与运算</span></span><br><span class="line">  &#123;</span><br><span class="line">    v28 = xmmword_410AA0;                       <span class="comment">// "Registration fai"</span></span><br><span class="line">    v29 = 'erul';</span><br><span class="line">    *(_OWORD *)Src = xmmword_410A90;            <span class="comment">// "Registration SucRegistration fai"</span></span><br><span class="line">    v30 = <span class="string">'.'</span>;</span><br><span class="line">    v26 = xmmword_410A80;                       <span class="comment">// "Your flag Registration SucRegistration fai"</span></span><br><span class="line">    v27 = ':si';</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strlen</span>(v11) != <span class="number">16</span></span><br><span class="line">      || v11[<span class="number">0</span>] != <span class="string">'C'</span></span><br><span class="line">      || v23 != <span class="string">'X'</span></span><br><span class="line">      || v11[<span class="number">1</span>] != <span class="string">'Z'</span></span><br><span class="line">      || v11[<span class="number">1</span>] + v22 != <span class="number">155</span>                    <span class="comment">// v22 == 'A'</span></span><br><span class="line">      || v11[<span class="number">2</span>] != <span class="string">'9'</span></span><br><span class="line">      || v11[<span class="number">2</span>] + v21 != <span class="number">155</span>                    <span class="comment">// v21 == 'b'</span></span><br><span class="line">      || v11[<span class="number">3</span>] != <span class="string">'d'</span></span><br><span class="line">      || v20 != <span class="string">'7'</span></span><br><span class="line">      || v12 != <span class="string">'m'</span></span><br><span class="line">      || v19 != <span class="string">'G'</span></span><br><span class="line">      || v13 != <span class="string">'q'</span></span><br><span class="line">      || v13 + v18 != <span class="number">170</span>                       <span class="comment">// v18 == '9'</span></span><br><span class="line">      || v14 != <span class="string">'4'</span></span><br><span class="line">      || v17 != <span class="string">'g'</span></span><br><span class="line">      || v15 != <span class="string">'c'</span></span><br><span class="line">      || v16 != <span class="string">'8'</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      strcpy_s(&amp;Text, <span class="number">0x100</span>u, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v28);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      strcpy_s(&amp;Text, <span class="number">0x100</span>u, Src);</span><br><span class="line">      strcat_s(&amp;Text, <span class="number">0x100</span>u, v11);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    strcpy_s(&amp;Text, <span class="number">0x100</span>u, <span class="string">"Your E-mail address in not valid."</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  MessageBoxA(hDlg, &amp;Text, <span class="string">"Registeration"</span>, <span class="number">0x40</span>u);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://sz.guiu.xyz/images/2020/02/25/1569254213469.png" alt="1569254213469.png"></p>
<p>此题终结。</p>
<p>flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CZ9dmq4c8g9G7bAX</span><br></pre></td></tr></table></figure>
<hr>
<h1>re11 ReverseMe-120</h1>
<p>这个题卡住了，看出来了是base64解码，但是解码表没搞明白，所以一开始一直按换表base64来解的。然后一直进行不下去了。</p>
<p>首先ida打开：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v4; <span class="comment">// ecx</span></span><br><span class="line">  __m128i v5; <span class="comment">// xmm1</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">const</span> __m128i *v7; <span class="comment">// eax</span></span><br><span class="line">  __m128i v8; <span class="comment">// xmm0</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// [esp+0h] [ebp-CCh]</span></span><br><span class="line">  <span class="keyword">char</span> v12; <span class="comment">// [esp+1h] [ebp-CBh]</span></span><br><span class="line">  <span class="keyword">char</span> v13; <span class="comment">// [esp+64h] [ebp-68h]</span></span><br><span class="line">  <span class="keyword">char</span> v14; <span class="comment">// [esp+65h] [ebp-67h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v15; <span class="comment">// [esp+C8h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"please input your flah:"</span>);</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v12, <span class="number">0</span>, <span class="number">0x63</span>u);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;v11);</span><br><span class="line">  v13 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v14, <span class="number">0</span>, <span class="number">0x63</span>u);</span><br><span class="line">  sub_401000(&amp;v15, &amp;v13, (<span class="keyword">unsigned</span> __int8 *)&amp;v11, <span class="built_in">strlen</span>(&amp;v11));<span class="comment">// 对输入的部分进行base64解码</span></span><br><span class="line">  v3 = v15;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v15 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v15 &gt;= <span class="number">16</span> )                            <span class="comment">// 中间这一部分就是垃圾代码</span></span><br><span class="line">    &#123;</span><br><span class="line">      v5 = _mm_load_si128((<span class="keyword">const</span> __m128i *)&amp;xmmword_414F20);<span class="comment">// 414f20 = "%%%%%%%%%%%%%%%%H"</span></span><br><span class="line">      v6 = v15 - (v15 &amp; <span class="number">15</span>);</span><br><span class="line">      v7 = (<span class="keyword">const</span> __m128i *)&amp;v13;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v8 = _mm_loadu_si128(v7);</span><br><span class="line">        v4 += <span class="number">16</span>;</span><br><span class="line">        ++v7;</span><br><span class="line">        _mm_storeu_si128((__m128i *)&amp;v7[<span class="number">-1</span>], _mm_xor_si128(v8, v5));</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v4 &lt; v6 );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( ; v4 &lt; v3; ++v4 )</span><br><span class="line">      *(&amp;v13 + v4) ^= <span class="number">0x25</span>u;                    <span class="comment">// 解码完了与0x25异或，最后与"you_know_how_to_remove_junk_code"对比</span></span><br><span class="line">  &#125;</span><br><span class="line">  v9 = <span class="built_in">strcmp</span>(&amp;v13, <span class="string">"you_know_how_to_remove_junk_code"</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v9 )</span><br><span class="line">    v9 = -(v9 &lt; <span class="number">0</span>) | <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v9 )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"wrong\n"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"correct\n"</span>);</span><br><span class="line">  system(<span class="string">"pause"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>base64解码部分：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">signed</span> <span class="keyword">int</span> __usercall sub_401000@&lt;eax&gt;(<span class="keyword">unsigned</span> <span class="keyword">int</span> *a1@&lt;edx&gt;, _BYTE *a2@&lt;ecx&gt;, <span class="keyword">unsigned</span> __int8 *a3, <span class="keyword">unsigned</span> <span class="keyword">int</span> a4)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 *v7; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">bool</span> v9; <span class="comment">// zf</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v10; <span class="comment">// cl</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// cl</span></span><br><span class="line">  _BYTE *v12; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v13; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v15; <span class="comment">// cl</span></span><br><span class="line">  <span class="keyword">char</span> v16; <span class="comment">// dl</span></span><br><span class="line">  _BYTE *v18; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> *v19; <span class="comment">// [esp+10h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> v20; <span class="comment">// [esp+14h] [ebp-4h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v21; <span class="comment">// [esp+14h] [ebp-4h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+24h] [ebp+Ch]</span></span><br><span class="line"></span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v18 = a2;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v19 = a1;</span><br><span class="line">  v20 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !a4 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v7 = a3;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v8 = <span class="number">0</span>;</span><br><span class="line">    v9 = v5 == a4;</span><br><span class="line">    <span class="keyword">if</span> ( v5 &lt; a4 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( a3[v5] != <span class="string">' '</span> )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        ++v5;</span><br><span class="line">        ++v8;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v5 &lt; a4 );</span><br><span class="line">      v9 = v5 == a4;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v9 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( a4 - v5 &gt;= <span class="number">2</span> &amp;&amp; a3[v5] == <span class="string">'\r'</span> &amp;&amp; a3[v5 + <span class="number">1</span>] == <span class="string">'\n'</span> || (v10 = a3[v5], v10 == <span class="string">'\n'</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = v20;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v8 )</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-44</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v10 == <span class="string">'='</span> &amp;&amp; (<span class="keyword">unsigned</span> <span class="keyword">int</span>)++v4 &gt; <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-44</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v10 &gt; <span class="string">''</span> )</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-44</span>;</span><br><span class="line">      v11 = byte_414E40[v10];</span><br><span class="line">      <span class="keyword">if</span> ( v11 == <span class="string">''</span> || (<span class="keyword">unsigned</span> __int8)v11 &lt; <span class="number">64u</span> &amp;&amp; v4 )</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-44</span>;</span><br><span class="line">      v6 = v20++ + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ++v5;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v5 &lt; a4 );</span><br><span class="line">  <span class="keyword">if</span> ( !v6 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v12 = v18;</span><br><span class="line">  v13 = ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)(<span class="number">6</span> * v6 + <span class="number">7</span>) &gt;&gt; <span class="number">3</span>) - v4;</span><br><span class="line">  <span class="keyword">if</span> ( v18 &amp;&amp; *v19 &gt;= v13 )</span><br><span class="line">  &#123;</span><br><span class="line">    v21 = <span class="number">3</span>;</span><br><span class="line">    v14 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; v5; --v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      v15 = *v7;</span><br><span class="line">      <span class="keyword">if</span> ( *v7 != <span class="number">13</span> &amp;&amp; v15 != <span class="number">10</span> &amp;&amp; v15 != <span class="number">32</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v16 = byte_414E40[v15];                 <span class="comment">// 414e40 = "&gt;?456789:;&lt;=@"</span></span><br><span class="line">        v21 -= v16 == <span class="number">64</span>;</span><br><span class="line">        v14 = v16 &amp; <span class="number">63</span> | (v14 &lt;&lt; <span class="number">6</span>);</span><br><span class="line">        <span class="keyword">if</span> ( ++i == <span class="number">4</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          i = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">if</span> ( v21 )</span><br><span class="line">            *v12++ = BYTE2(v14);</span><br><span class="line">          <span class="keyword">if</span> ( v21 &gt; <span class="number">1</span> )</span><br><span class="line">            *v12++ = BYTE1(v14);</span><br><span class="line">          <span class="keyword">if</span> ( v21 &gt; <span class="number">2</span> )</span><br><span class="line">            *v12++ = v14;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      ++v7;</span><br><span class="line">    &#125;</span><br><span class="line">    *v19 = v12 - v18;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *v19 = v13;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">-42</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>解码表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">7F 7F 7F 7F 7F 7F 7F 7F  7F 7F 7F 7F 7F 7F 7F 7F</span><br><span class="line">7F 7F 7F 7F 7F 7F 7F 7F  7F 7F 7F 7F 7F 7F 7F 7F</span><br><span class="line">7F 7F 7F 7F 7F 7F 7F 7F  7F 7F 7F 3E 7F 7F 7F 3F</span><br><span class="line">34 35 36 37 38 39 3A 3B  3C 3D 7F 7F 7F 40 7F 7F</span><br><span class="line">7F 00 01 02 03 04 05 06  07 08 09 0A 0B 0C 0D 0E</span><br><span class="line">0F 10 11 12 13 14 15 16  17 18 19 7F 7F 7F 7F 7F</span><br><span class="line">7F 1A 1B 1C 1D 1E 1F 20  21 22 23 24 25 26 27 28</span><br><span class="line">29 2A 2B 2C 2D 2E 2F 30  31 32 33 7F 7F 7F 7F 7F</span><br></pre></td></tr></table></figure>
<p>一开始是当成编码表来看的，所以就以为是换表base64，还是太菜了啊TvT。</p>
<p>照样解密代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">str = <span class="string">"you_know_how_to_remove_junk_code"</span></span><br><span class="line">temp = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> str:</span><br><span class="line">    temp += chr(ord(i) ^ <span class="number">0x25</span>)</span><br><span class="line"></span><br><span class="line">print(base64.b64encode(temp.encode()))</span><br></pre></td></tr></table></figure>
<p>flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XEpQek5LSlJ6TUpSelFKeldASEpTQHpPUEtOekZKQUA&#x3D;</span><br></pre></td></tr></table></figure>
<hr>
<h1>re12 reverse-box</h1>
<p>这题要用到gdb脚本，想顺便学习整理一下gdb和ida的远程调试，就先不写writeup</p>
<h1>re13 IgniteMe</h1>
<p>不知道为啥到现在为止攻防世界的逆向题都这么简单，感觉套路都是一样的，而且考察的点也差不多。</p>
<p>分析过程就不写了，直接放解密脚本，从脚本也能看出加密过程了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">byte = [</span><br><span class="line">    <span class="number">0x0D</span>, <span class="number">0x13</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x20</span>, <span class="number">0x1D</span>,  <span class="number">0x0C</span>, </span><br><span class="line">    <span class="number">0x02</span>, <span class="number">0x19</span>, <span class="number">0x2F</span>, <span class="number">0x17</span>, <span class="number">0x2B</span>, <span class="number">0x24</span>, <span class="number">0x1F</span>,<span class="number">0x1E</span>, <span class="number">0x16</span>, </span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x0F</span>, <span class="number">0x15</span>, <span class="number">0x27</span>, <span class="number">0x13</span>, <span class="number">0x26</span>,  <span class="number">0x0A</span>, <span class="number">0x2F</span>, <span class="number">0x1E</span>,</span><br><span class="line">    <span class="number">0x1A</span>, <span class="number">0x2D</span>, <span class="number">0x0C</span>, <span class="number">0x22</span>, <span class="number">0x04</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">temp = <span class="string">"GONDPHyGjPEKruv&#123;&#123;pj]X@rF"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(temp)):</span><br><span class="line">    asci = ((ord(temp[i])^byte[i])<span class="number">-72</span>)^<span class="number">0x55</span></span><br><span class="line">    <span class="keyword">if</span> asci &gt;= <span class="number">65</span> <span class="keyword">and</span> asci &lt;= <span class="number">90</span>:</span><br><span class="line">        asci += <span class="number">32</span></span><br><span class="line">    <span class="keyword">elif</span> asci &gt;= <span class="number">97</span> <span class="keyword">and</span> asci &lt;= <span class="number">122</span>:</span><br><span class="line">        asci -= <span class="number">32</span></span><br><span class="line">    flag += chr(asci)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<hr>
<h1>re16  handcrafted-pyc</h1>
<p>这个题涉及到python反序列化的问题</p>
<hr>
<h1>re18 zorropub</h1>
<p>先上代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [rsp+1Ch] [rbp-104h]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [rsp+20h] [rbp-100h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+24h] [rbp-FCh]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> seed; <span class="comment">// [rsp+28h] [rbp-F8h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v9; <span class="comment">// [rsp+2Ch] [rbp-F4h]</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [rsp+30h] [rbp-F0h]</span></span><br><span class="line">  <span class="keyword">char</span> v11[<span class="number">16</span>]; <span class="comment">// [rsp+90h] [rbp-90h]</span></span><br><span class="line">  <span class="keyword">char</span> v12[<span class="number">32</span>]; <span class="comment">// [rsp+A0h] [rbp-80h]</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+C0h] [rbp-60h]</span></span><br><span class="line">  <span class="keyword">char</span> s1[<span class="number">40</span>]; <span class="comment">// [rsp+E0h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v15; <span class="comment">// [rsp+108h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v15 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  seed = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Welcome to Pub Zorro!!"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Straight to the point. How many drinks you want?"</span>, a2);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%d"</span>, &amp;v5);</span><br><span class="line">  <span class="keyword">if</span> ( v5 &lt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"You are too drunk!! Get Out!!"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"OK. I need details of all the drinks. Give me %d drink ids:"</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v5);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v5; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    __isoc99_scanf(<span class="string">"%d"</span>, &amp;v6);</span><br><span class="line">    <span class="keyword">if</span> ( v6 &lt;= <span class="number">16</span> || v6 &gt; <span class="number">0xFFFF</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"Invalid Drink Id."</span>);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"Get Out!!"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    seed ^= v6;</span><br><span class="line">  &#125;</span><br><span class="line">  i = seed;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( i )			<span class="comment">// 这里是seed要满足的条件</span></span><br><span class="line">  &#123;</span><br><span class="line">    ++v9;</span><br><span class="line">    i &amp;= i - <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v9 != <span class="number">10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Looks like its a dangerous combination of drinks right there."</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Get Out, you will get yourself killed"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  srand(seed);</span><br><span class="line">  MD5_Init(&amp;v10);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">29</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v9 = rand() % <span class="number">1000</span>;                         <span class="comment">// v9 = srand(seed)的随机数  每次循环生成一个随机数，最终对比的应该是第30个</span></span><br><span class="line">    <span class="built_in">sprintf</span>(&amp;s, <span class="string">"%d"</span>, v9);</span><br><span class="line">    v3 = <span class="built_in">strlen</span>(&amp;s);</span><br><span class="line">    MD5_Update(&amp;v10, &amp;s, v3);                   <span class="comment">// 对生成的随机数进行md5加密，加密结果为v10</span></span><br><span class="line">    v12[i] = v9 ^ LOBYTE(dword_6020C0[i]);      <span class="comment">// v12是待加密的随机数与该数组异或后的结果（最终flag）</span></span><br><span class="line">  &#125;</span><br><span class="line">  v12[i] = <span class="number">0</span>;</span><br><span class="line">  MD5_Final(v11, &amp;v10);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )</span><br><span class="line">    <span class="built_in">sprintf</span>(&amp;s1[<span class="number">2</span> * i], <span class="string">"%02x"</span>, (<span class="keyword">unsigned</span> __int8)v11[i]);<span class="comment">// 两位一组，十六进制放入s1</span></span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strcmp</span>(s1, <span class="string">"5eba99aff105c9ff6a1a913e343fec67"</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Try different mix, This mix is too sloppy"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"\nYou choose right mix and here is your reward: The flag is nullcon&#123;%s&#125;\n"</span>, v12);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>又是MD5又是随机数的，只能写脚本爆破了。后面比对的部分倒是好实现，只是伪随机数的部分不好弄。</p>
<p>对于逆向来说，理清思路和逻辑是一方面，但是写代码<code>get flag</code>又是另一个更重要的方面，所以也需要掌握更多快速解题的技巧。</p>
<p>这里学会了一个新姿势，上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">time1=time.time()</span><br><span class="line">a=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>,<span class="number">0xffff</span>):		<span class="comment"># 这里是生成符合条件的数组</span></span><br><span class="line">	v9=<span class="number">0</span></span><br><span class="line">	i=i^<span class="number">0</span></span><br><span class="line">	j=i</span><br><span class="line">	<span class="keyword">while</span>(i):</span><br><span class="line">		v9+=<span class="number">1</span></span><br><span class="line">		i&amp;=i<span class="number">-1</span></span><br><span class="line">	<span class="keyword">if</span> v9 ==<span class="number">10</span>:</span><br><span class="line">		a.append(j)</span><br><span class="line">//数组已经弄好了</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">	p=process(<span class="string">"./zorropub"</span>)</span><br><span class="line">	p.recv()</span><br><span class="line">	p.sendline(<span class="string">'1'</span>)		<span class="comment"># 向程序中输入数据</span></span><br><span class="line">	p.sendline(str(i))	<span class="comment"># emmm，觉得int的也ok</span></span><br><span class="line">	result=p.recv()</span><br><span class="line">	<span class="keyword">if</span> <span class="string">"null"</span> <span class="keyword">in</span> text:</span><br><span class="line">		<span class="keyword">print</span> text</span><br><span class="line">		time2=time.time()</span><br><span class="line">		<span class="keyword">print</span> <span class="string">"time %fs"</span>%(time2-time1)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">p.close()</span><br></pre></td></tr></table></figure>
<p>这里是用到了<code>pwn</code>这个库，因为后面的自己写代码爆破比较麻烦，而前面符合要求的数组比较好得到。所以这里<code>可</code>以控制输入的参数，然后实现爆破的目的。</p>
<p>好像是解pwn的库，看来得专门去学一下了~</p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>guiu
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://guiu.xyz/p/9e8c7ad8.html" title="攻防世界re-writeup">http://guiu.xyz/p/9e8c7ad8.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/CTF/" rel="tag"># CTF</a>
              <a href="/tags/Writeup/" rel="tag"># Writeup</a>
              <a href="/tags/%E9%80%86%E5%90%91/" rel="tag"># 逆向</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/p/3c330a16.html" rel="prev" title="使用python3解析html网页表格">
      <i class="fa fa-chevron-left"></i> 使用python3解析html网页表格
    </a></div>
      <div class="post-nav-item">
    <a href="/p/f4951776.html" rel="next" title="逆向入门参考">
      逆向入门参考 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-number">1.</span> <span class="nav-text">re3 re2-cpp-is-awesome</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-number">2.</span> <span class="nav-text">re4  crackme</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-number">3.</span> <span class="nav-text">re5 re-for-50-plz-50</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-number">4.</span> <span class="nav-text">re6 key</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-number">5.</span> <span class="nav-text">re7 simple-check-100</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-number">6.</span> <span class="nav-text">re8 re1-100</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-number">7.</span> <span class="nav-text">re9 The_Maya_Society</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-number">8.</span> <span class="nav-text">re10 srm-50</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-number">9.</span> <span class="nav-text">re11 ReverseMe-120</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-number">10.</span> <span class="nav-text">re12 reverse-box</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-number">11.</span> <span class="nav-text">re13 IgniteMe</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-number">12.</span> <span class="nav-text">re16  handcrafted-pyc</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-number">13.</span> <span class="nav-text">re18 zorropub</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="guiu"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">guiu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">27</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        
<div class="copyright">
  <span><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">蜀ICP备19032161号-1 </a>
  </span>
  <span class="post-meta-divider">|</span>


  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2020</span>

  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">guiu</span>

</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.7.1
  </div>

        
<div class="busuanzi-count">
 <!--修复busuanzi有时候无法显示的问题，这里注释掉，改用本地js-->
   <!--<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>-->
  <script async src="/js/cursor/busuanzi_fix.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  


  <script async src="https://script-1256884783.file.myqcloud.com/cursor/fireworks.js"></script>



  
<script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"left","width":100,"height":180},"mobile":{"show":false},"react":{"opacityDefault":0.7}});</script></body>
</html>
